return(mean(lodds, na.rm = TRUE))
}
if(response == "multinomial"){
#the first response in the multinomial is the reference, we will call it J
category = which(apply((miss.patterns[[2]]), 1, sum) == 1)
J = category[1]
#take only the control group
P_J = (r[,1,J]/n[,1])[t[,1]==1]
P_j = matrix(0, ncol = ncat-1, nrow = sum(t[,1]==1))
for(j in 2:ncat){
P_j[,j-1] = (r[,1,category[j]]/n[,1])[t[,1]==1]
}
lodds = log(P_j/P_J)
return(apply(lodds, 2, mean, na.rm = TRUE))
}
}
})
calculate.baseline.log.odds <- function(network){
mx_bl <-
with(network,{
if(baseline %in% c("independent", "common", "exchangeable")){
if(response == "normal"){
return(mean(r[,1][t[,1]==1], na.rm = TRUE))
}
if(response == "binomial"){
rdummy = r[,1]
rdummy[r[,1] == 0] = 0.5
ndummy = n[,1]
ndummy[r[,1] == 0 & !is.na(r[,1])] = ndummy[r[,1] == 0 & !is.na(r[,1])] + 1
#take only the non-active control group (treatment A) to calculate the observed mean log odds
p = (rdummy[!is.na(rdummy)]/ndummy[!is.na(rdummy)]) #[t[,1][!is.na(rdummy)]==1]
lodds = log(p/(1-p))
return(mean(lodds, na.rm = TRUE))
}
if(response == "multinomial"){
#the first response in the multinomial is the reference, we will call it J
category = which(apply((miss.patterns[[2]]), 1, sum) == 1)
J = category[1]
#take only the control group
P_J = (r[,1,J]/n[,1])[t[,1]==1]
P_j = matrix(0, ncol = ncat-1, nrow = sum(t[,1]==1))
for(j in 2:ncat){
P_j[,j-1] = (r[,1,category[j]]/n[,1])[t[,1]==1]
}
lodds = log(P_j/P_J)
return(apply(lodds, 2, mean, na.rm = TRUE))
}
}
})
return(mx_bl)
}
calculate.baseline.log.odds(network)
devtools::install_github("MikeJSeo/bnma")
network <- with(smoking, network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial", baseline = "common", baseline.risk = "exchangeable")) #Model A2
library(bnma)
network <- with(smoking, network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial", baseline = "common", baseline.risk = "exchangeable")) #Model A2
result <- network.run(network)
cat(network$code)
devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- with(smoking, network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial", baseline = "common", baseline.risk = "exchangeable")) #Model A2
result <- network.run(network)
cat(network$code)
str(network)
devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- with(smoking, network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial", baseline = "common", baseline.risk = "exchangeable")) #Model A2
result <- network.run(network)
summary(result)
smoking
smoking
Outcomes <- c(10, 18, 5, 8, 46, 61, 5, 16, 26, 37, 816, 866, 55, 109, 112, 130, 619, 692, 71, 81, 325, 345, 321, 325, 54, 77, 6, 6, 211, 136, 47, 47, 34, 39, 6, 27, 394, 406, 997, 1421)
N <- c(297, 308, 30, 44, 105, 108, 10, 17, 40, 38, 1060, 902, 71, 139, 138, 140, 737, 764, 82, 83, 375, 384, 363, 361, 56, 80, 12, 12, 211, 136, 56, 58, 38, 41, 50, 47, 469, 482, 1545, 1583)
Treat <- c(1, 2, 1, 5, 1, 3, 1, 4, 1, 4, 1, 7, 1, 2, 1, 7, 1, 5, 1, 3, 1, 2, 1, 4, 1, 2, 4, 6, 4, 6, 3, 4, 2, 3, 2, 5, 4, 6, 4, 7)
Study <- rep(1:20, each = 2)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial", baseline = "common", baseline.risk = "exchangeable") #Model A2
result <- network.run(network)
summary(result)
Outcomes <- c(10, 18, 5, 8, 46, 61, 5, 16, 26, 37, 816, 866, 55, 109, 112, 130, 619, 692, 71, 81, 325, 345, 321, 325, 54, 77, NA, 6, 6, NA, 211, 136, NA, 47, 47, NA, 34, 39, NA, 6, 27, NA, 394, 406, NA, 997, 1421)
N <- c(297, 308, 30, 44, 105, 108, 10, 17, 40, 38, 1060, 902, 71, 139, 138, 140, 737, 764, 82, 83, 375, 384, 363, 361, 56, 80, 1, 12, 12, 1, 211, 136, 1, 56, 58, 1, 38, 41, 1, 50, 47, 1, 469, 482, 1, 1545, 1583)
Treat <- c(1, 2, 1, 5, 1, 3, 1, 4, 1, 4, 1, 7, 1, 2, 1, 7, 1, 5, 1, 3, 1, 2, 1, 4, 1, 2, 1, 4, 6, 1, 4, 6, 1, 3, 4, 1, 2, 3, 1, 2, 5, 1, 4, 6, 1, 4, 7)
Study <- c(rep(1:13, each = 2), rep(14:20, each = 3))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial", baseline = "common", baseline.risk = "exchangeable") #Model A2
result <- network.run(network)
summary(result)
cat(network$code)
str(network)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial", baseline = "common", baseline.risk = "exchangeable", prec.bl = 0.0001, hy.prior = list("dunif", 0, 100)) #Model A2
result <- network.run(network)
summary(result)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial") #Model 0
result <- network.run(network)
cat(network$code)
devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial") #Model 0
Outcomes <- c(10, 18, 5, 8, 46, 61, 5, 16, 26, 37, 816, 866, 55, 109, 112, 130, 619, 692, 71, 81, 325, 345, 321, 325, 54, 77, NA, 6, 6, NA, 211, 136, NA, 47, 47, NA, 34, 39, NA, 6, 27, NA, 394, 406, NA, 997, 1421)
N <- c(297, 308, 30, 44, 105, 108, 10, 17, 40, 38, 1060, 902, 71, 139, 138, 140, 737, 764, 82, 83, 375, 384, 363, 361, 56, 80, 1, 12, 12, 1, 211, 136, 1, 56, 58, 1, 38, 41, 1, 50, 47, 1, 469, 482, 1, 1545, 1583)
Treat <- c(1, 2, 1, 5, 1, 3, 1, 4, 1, 4, 1, 7, 1, 2, 1, 7, 1, 5, 1, 3, 1, 2, 1, 4, 1, 2, 1, 4, 6, 1, 4, 6, 1, 3, 4, 1, 2, 3, 1, 2, 5, 1, 4, 6, 1, 4, 7)
Study <- c(rep(1:13, each = 2), rep(14:20, each = 3))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial") #Model 0
Outcomes
N
Outcomes <- c(10, 18, 5, 8, 46, 61, 5, 16, 26, 37, 816, 866, 55, 109, 112, 130, 619, 692, 71, 81, 325, 345, 321, 325, 54, 77, 6, 6, 211, 136, 47, 47, 34, 39, 6, 27, 394, 406, 997, 1421)
N <- c(297, 308, 30, 44, 105, 108, 10, 17, 40, 38, 1060, 902, 71, 139, 138, 140, 737, 764, 82, 83, 375, 384, 363, 361, 56, 80, 12, 12, 211, 136, 56, 58, 38, 41, 50, 47, 469, 482, 1545, 1583)
Treat <- c(1, 2, 1, 5, 1, 3, 1, 4, 1, 4, 1, 7, 1, 2, 1, 7, 1, 5, 1, 3, 1, 2, 1, 4, 1, 2, 4, 6, 4, 6, 3, 4, 2, 3, 2, 5, 4, 6, 4, 7)
Study <- rep(1:20, each = 2)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial") #Model 0
result <- network.run(network)
str(network)
devtools::install_github("MikeJSeo/bnma")
devtools::install_github("MikeJSeo/bnma")
devtools::install_github("MikeJSeo/bnma")
devtools::install_github("MikeJSeo/bnma")
library(bnma)
Outcomes <- c(10, 18, 5, 8, 46, 61, 5, 16, 26, 37, 816, 866, 55, 109, 112, 130, 619, 692, 71, 81, 325, 345, 321, 325, 54, 77, 6, 6, 211, 136, 47, 47, 34, 39, 6, 27, 394, 406, 997, 1421)
N <- c(297, 308, 30, 44, 105, 108, 10, 17, 40, 38, 1060, 902, 71, 139, 138, 140, 737, 764, 82, 83, 375, 384, 363, 361, 56, 80, 12, 12, 211, 136, 56, 58, 38, 41, 50, 47, 469, 482, 1545, 1583)
Treat <- c(1, 2, 1, 5, 1, 3, 1, 4, 1, 4, 1, 7, 1, 2, 1, 7, 1, 5, 1, 3, 1, 2, 1, 4, 1, 2, 4, 6, 4, 6, 3, 4, 2, 3, 2, 5, 4, 6, 4, 7)
Study <- rep(1:20, each = 2)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial") #Model 0
result <- network.run(network)
library(mcnet)
Outcomes <- c(10, 18, 5, 8, 46, 61, 5, 16, 26, 37, 816, 866, 55, 109, 112, 130, 619, 692, 71, 81, 325, 345, 321, 325, 54, 77, 6, 6, 211, 136, 47, 47, 34, 39, 6, 27, 394, 406, 997, 1421)
N <- c(297, 308, 30, 44, 105, 108, 10, 17, 40, 38, 1060, 902, 71, 139, 138, 140, 737, 764, 82, 83, 375, 384, 363, 361, 56, 80, 12, 12, 211, 136, 56, 58, 38, 41, 50, 47, 469, 482, 1545, 1583)
Treat <- c(1, 2, 1, 5, 1, 3, 1, 4, 1, 4, 1, 7, 1, 2, 1, 7, 1, 5, 1, 3, 1, 2, 1, 4, 1, 2, 4, 6, 4, 6, 3, 4, 2, 3, 2, 5, 4, 6, 4, 7)
Study <- rep(1:20, each = 2)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial") #Model 0
result <- network.run(network)
summary(result)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial", baseline = "common") #Model A1
result <- network.run(network)
summary(result, extra.pars = "delta")
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial", baseline = "common") #Model A1
result <- network.run(network)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial", baseline = "common", baseline.risk = "exchangeable") #Model A2
result <- network.run(network)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, N = N, response = "binomial", baseline = "common") #Model A1
cat(network$code)
network$mx_bl
network$mx_bl
install_github("MikeJSeo/bnma")
devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- with(cardiovascular, network.data(Outcomes, Study, Treat, N, response = "multinomial"))
result <- network.run(network)
summary(result)
devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- with(cardiovascular, network.data(Outcomes, Study, Treat, N, response = "multinomial"))
result <- network.run(network)
summary(result)
with(network, {
P_J = (r[,1,1]/n[,1])[t[,1]==1]
P_j = matrix(0, ncol = ncat-1, nrow = sum(t[,1]==1))
for(j in 2:ncat){
P_j[,j-1] = (r[,1,category[j]]/n[,1])[t[,1]==1]
}
lodds = log(P_j/P_J)
})
network
network <- with(cardiovascular, network.data(Outcomes, Study, Treat, N, response = "multinomial"))
devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- with(cardiovascular, network.data(Outcomes, Study, Treat, N, response = "multinomial"))
result <- network.run(network)
summary(result)
str(network)
devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- with(cardiovascular, network.data(Outcomes, Study, Treat, N, response = "multinomial"))
result <- network.run(network)
summary(result)
devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- with(cardiovascular, network.data(Outcomes, Study, Treat, N, response = "multinomial"))
result <- network.run(network)
summary(result)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", type = "fixed")
Study <- rep(1:17, each = 2)
Treat <- c(1,3,1,3,1,3,1,3,1,2,1,3,1,3,2,3,1,3,1,3,2,3,1,3,2,3,1,2,1,2,2,3,1,2)
Outcomes <- matrix(c(3869,4014,8760,8941,2607,2593,4544,4539,1329,1367,2155,2149,1967,2039,4075,4073,1882,1901,3158,3196,4724,4711,3224,3224,640,644,3887,3811,4925,4983,2102,2161,1131,1141,200,167,570,547,149,163,341,336,45,36,113,138,49,46,156,143,66,68,62,56,127,158,52,63,15,10,61,44,130,111,21,21,31,32,433,331,937,781,157,135,300,295,37,25,98,78,207,136,218,223,130,112,73,50,155,126,25,17,20,22,18,11,82,74,109,83,37,38), ncol = 3)
covariate <- c(1,2,4,2,3,5,6,7,8,1,12,2,3,4,2,3,4)
colnames(Outcomes) <- c("Alive", "FnCVD", "FCVD")
#Outcomes <- Outcomes[,c(2,1,3)]
N <- apply(Outcomes, 1, sum)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", type = "fixed")
result <- network.run(network)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", baseline = "exchangeable")
Outcomes
devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", baseline = "exchangeable")
network <- with(cardiovascular, network.data(Outcomes, Study, Treat, N, response = "multinomial", baseline = "common"))
result <- network.run(network)
summary(result)
calculate.deviance(result)
network.autocorr.diag(result)
network.autocorr.plot(result)
network.covariate.plot(result, base.treatment = 1, comparison.treatment = 2, base.category = 1, comparison.category = 2)
network.cumrank.tx.plot(result)
network.deviance.plot(result)
network.forest.plot(result, label.margin = 10)
network.gelman.diag(result)
network.gelman.plot(result)
Outcomes <- c(-1.22, -1.53, -0.7, -2.4, -0.3, -2.6, -1.2, -0.24, -0.59, -0.73, -0.18, -2.2, -2.5, -1.8, -2.1)
SE <- c(0.504, 0.439, 0.282, 0.258, 0.505, 0.510, 0.478, 0.265, 0.354, 0.335, 0.442, 0.197, 0.190, 0.200, 0.250)
Treat <- c(1, 3, 1, 2, 1, 2, 4, 3, 4, 3, 4, 4, 5, 4, 5)
covariate <- c(1,3,4,2,5,6,7)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", type = "fixed")
Study <- c(1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", type = "fixed")
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dhnorm", 0, 0.01))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", baseline = "exchangeable", hy.prior.bl = list("dgamma", 0.001, 0.001))
dim(covariate)[2]
dim(covariate)
devtools::install_github("MikeJSeo/bnma")
library(bnma)
library(rjags)
Outcomes <- c(-1.22, -1.53, -0.7, -2.4, -0.3, -2.6, -1.2, -0.24, -0.59, -0.73, -0.18, -2.2, -2.5, -1.8, -2.1)
SE <- c(0.504, 0.439, 0.282, 0.258, 0.505, 0.510, 0.478, 0.265, 0.354, 0.335, 0.442, 0.197, 0.190, 0.200, 0.250)
Treat <- c(1, 3, 1, 2, 1, 2, 4, 3, 4, 3, 4, 4, 5, 4, 5)
covariate <- c(1,3,4,2,5,6,7)
#covariate <- cbind(c(1,3,4,2,5,6,7), c(1,2,2,2,3,4,5)) #fake covariate
Study <- c(1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", type = "fixed")
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dhnorm", 0, 0.01))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", baseline = "exchangeable", hy.prior.bl = list("dgamma", 0.001, 0.001))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", type = "fixed")
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- with(cardiovascular, network.data(Outcomes, Study, Treat, N, response = "multinomial"))
network <- with(cardiovascular, network.data(Outcomes, Study, Treat, N, response = "multinomial"))
devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- with(cardiovascular, network.data(Outcomes, Study, Treat, N, response = "multinomial"))
result <- network.run(network)
summary(result)
covariate
library(bnma)
network <- with(cardiovascular, network.data(Outcomes, Study, Treat, N, response = "multinomial"))
result <- network.run(network)
library(rjags)
Outcomes <- c(-1.22, -1.53, -0.7, -2.4, -0.3, -2.6, -1.2, -0.24, -0.59, -0.73, -0.18, -2.2, -2.5, -1.8, -2.1)
SE <- c(0.504, 0.439, 0.282, 0.258, 0.505, 0.510, 0.478, 0.265, 0.354, 0.335, 0.442, 0.197, 0.190, 0.200, 0.250)
Treat <- c(1, 3, 1, 2, 1, 2, 4, 3, 4, 3, 4, 4, 5, 4, 5)
covariate <- c(1,3,4,2,5,6,7)
#covariate <- cbind(c(1,3,4,2,5,6,7), c(1,2,2,2,3,4,5)) #fake covariate
Study <- c(1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", type = "fixed")
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dhnorm", 0, 0.01))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", baseline = "exchangeable", hy.prior.bl = list("dgamma", 0.001, 0.001))
devtools::install_github("MikeJSeo/bnma")
Outcomes <- c(-1.22, -1.53, -0.7, -2.4, -0.3, -2.6, -1.2, -0.24, -0.59, -0.73, -0.18, -2.2, -2.5, -1.8, -2.1)
SE <- c(0.504, 0.439, 0.282, 0.258, 0.505, 0.510, 0.478, 0.265, 0.354, 0.335, 0.442, 0.197, 0.190, 0.200, 0.250)
Treat <- c(1, 3, 1, 2, 1, 2, 4, 3, 4, 3, 4, 4, 5, 4, 5)
covariate <- c(1,3,4,2,5,6,7)
#covariate <- cbind(c(1,3,4,2,5,6,7), c(1,2,2,2,3,4,5)) #fake covariate
Study <- c(1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
library(bnma)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", type = "fixed")
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dhnorm", 0, 0.01))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", baseline = "exchangeable", hy.prior.bl = list("dgamma", 0.001, 0.001))
devtools::install_github("MikeJSeo/bnma")
devtools::install_github("MikeJSeo/bnma")
library(bnma)
library(rjags)
Outcomes <- c(-1.22, -1.53, -0.7, -2.4, -0.3, -2.6, -1.2, -0.24, -0.59, -0.73, -0.18, -2.2, -2.5, -1.8, -2.1)
SE <- c(0.504, 0.439, 0.282, 0.258, 0.505, 0.510, 0.478, 0.265, 0.354, 0.335, 0.442, 0.197, 0.190, 0.200, 0.250)
Treat <- c(1, 3, 1, 2, 1, 2, 4, 3, 4, 3, 4, 4, 5, 4, 5)
covariate <- c(1,3,4,2,5,6,7)
#covariate <- cbind(c(1,3,4,2,5,6,7), c(1,2,2,2,3,4,5)) #fake covariate
Study <- c(1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", type = "fixed")
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dhnorm", 0, 0.01))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", baseline = "exchangeable", hy.prior.bl = list("dgamma", 0.001, 0.001))
result <- network.run(network)
cat(network$code)
install_github("MikeJSeo/bnma")
devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", baseline = "exchangeable", baseline.risk = "independent")
library(rjags)
Outcomes <- c(-1.22, -1.53, -0.7, -2.4, -0.3, -2.6, -1.2, -0.24, -0.59, -0.73, -0.18, -2.2, -2.5, -1.8, -2.1)
SE <- c(0.504, 0.439, 0.282, 0.258, 0.505, 0.510, 0.478, 0.265, 0.354, 0.335, 0.442, 0.197, 0.190, 0.200, 0.250)
Treat <- c(1, 3, 1, 2, 1, 2, 4, 3, 4, 3, 4, 4, 5, 4, 5)
covariate <- c(1,3,4,2,5,6,7)
#covariate <- cbind(c(1,3,4,2,5,6,7), c(1,2,2,2,3,4,5)) #fake covariate
Study <- c(1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", baseline = "exchangeable", hy.prior.bl = list("dgamma", 0.001, 0.001))
result <- network.run(network)
covariate <- cbind(c(1,3,4,2,5,6,7), c(1,2,2,2,3,4,5)) #fake covariate
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", type = "fixed")
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dhnorm", 0, 0.01))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", baseline = "exchangeable", hy.prior.bl = list("dgamma", 0.001, 0.001))
result <- network.run(network)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", type = "fixed")
result <- network.run(network)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
result <- network.run(network)
network
calculate.covariate.mean(network)
calculate.covariate.mean <- function(network){
with(network,{
# calculate mean of covariate
store <- list()
if(!is.null(covariate)){
for(i in 1:dim(covariate)[2]){
nam <- paste("mx",i, sep = "")
nam <- assign(nam, mean(covariate[,i], na.rm = TRUE))
network[[paste("mx",i, sep = "")]] <- ifelse(covariate.type[i] == "continuous", nam, 0)
nam2 <- paste("x", i, sep = "")
nam2 <- assign(nam2, covariate[,i])
store[[paste("x", i, sep = "")]] <- nam2
}
}
return(store)
})
}
calculate.covariate.mean(network)
devtools::install_github("MikeJSeo/bnma")
library(bnma)
library(rjags)
Outcomes <- c(-1.22, -1.53, -0.7, -2.4, -0.3, -2.6, -1.2, -0.24, -0.59, -0.73, -0.18, -2.2, -2.5, -1.8, -2.1)
SE <- c(0.504, 0.439, 0.282, 0.258, 0.505, 0.510, 0.478, 0.265, 0.354, 0.335, 0.442, 0.197, 0.190, 0.200, 0.250)
Treat <- c(1, 3, 1, 2, 1, 2, 4, 3, 4, 3, 4, 4, 5, 4, 5)
covariate <- c(1,3,4,2,5,6,7)
covariate <- cbind(c(1,3,4,2,5,6,7), c(1,2,2,2,3,4,5)) #fake covariate
Study <- c(1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", type = "fixed")
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dhnorm", 0, 0.01))
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", baseline = "exchangeable", hy.prior.bl = list("dgamma", 0.001, 0.001))
result <- network.run(network)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
result <- network.run(network)
network
devtools::install_github("MikeJSeo/bnma")
library(bnma)
library(rjags)
Outcomes <- c(-1.22, -1.53, -0.7, -2.4, -0.3, -2.6, -1.2, -0.24, -0.59, -0.73, -0.18, -2.2, -2.5, -1.8, -2.1)
SE <- c(0.504, 0.439, 0.282, 0.258, 0.505, 0.510, 0.478, 0.265, 0.354, 0.335, 0.442, 0.197, 0.190, 0.200, 0.250)
Treat <- c(1, 3, 1, 2, 1, 2, 4, 3, 4, 3, 4, 4, 5, 4, 5)
covariate <- c(1,3,4,2,5,6,7)
covariate <- cbind(c(1,3,4,2,5,6,7), c(1,2,2,2,3,4,5)) #fake covariate
Study <- c(1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", type = "fixed")
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
result <- network.run(network)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dhnorm", 0, 0.01))
result <- network.run(network)
Outcomes <- c(-1.22, -1.53, -0.7, -2.4, -0.3, -2.6, -1.2, -0.24, -0.59, -0.73, -0.18, -2.2, -2.5, -1.8, -2.1)
SE <- c(0.504, 0.439, 0.282, 0.258, 0.505, 0.510, 0.478, 0.265, 0.354, 0.335, 0.442, 0.197, 0.190, 0.200, 0.250)
Treat <- c(1, 3, 1, 2, 1, 2, 4, 3, 4, 3, 4, 4, 5, 4, 5)
covariate <- c(1,3,4,2,5,6,7)
covariate <- cbind(c(1,3,4,2,5,6,7), c(1,2,2,2,3,4,5)) #fake covariate
Study <- c(1, 1, 2, 2, 3, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", type = "fixed")
result <- network.run(network)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dgamma", 0.001, 0.001))
result <- network.run(network)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", covariate = covariate, covariate.model = "exchangeable", hy.prior.cov = list("dhnorm", 0, 0.01))
result <- network.run(network)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", baseline = "exchangeable", hy.prior.bl = list("dgamma", 0.001, 0.001))
result <- network.run(network)
Treat.order <- c(2,1,3,4,5)
network <- network.data(Outcomes = Outcomes, Treat = Treat, Study = Study, SE = SE, response = "normal", Treat.order = Treat.order)
result2 <- network.run(network)
Study <- rep(1:17, each = 2)
Treat <- c(1,3,1,3,1,3,1,3,1,2,1,3,1,3,2,3,1,3,1,3,2,3,1,3,2,3,1,2,1,2,2,3,1,2)
Outcomes <- matrix(c(3869,4014,8760,8941,2607,2593,4544,4539,1329,1367,2155,2149,1967,2039,4075,4073,1882,1901,3158,3196,4724,4711,3224,3224,640,644,3887,3811,4925,4983,2102,2161,1131,1141,200,167,570,547,149,163,341,336,45,36,113,138,49,46,156,143,66,68,62,56,127,158,52,63,15,10,61,44,130,111,21,21,31,32,433,331,937,781,157,135,300,295,37,25,98,78,207,136,218,223,130,112,73,50,155,126,25,17,20,22,18,11,82,74,109,83,37,38), ncol = 3)
covariate <- c(1,2,4,2,3,5,6,7,8,1,12,2,3,4,2,3,4)
colnames(Outcomes) <- c("Alive", "FnCVD", "FCVD")
#Outcomes <- Outcomes[,c(2,1,3)]
N <- apply(Outcomes, 1, sum)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", type = "fixed")
result <- network.run(network)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", covariate = covariate, covariate.model = "exchangeable")
devtools::install_github("MikeJSeo/bnma")
library(bnma)
Study <- rep(1:17, each = 2)
Treat <- c(1,3,1,3,1,3,1,3,1,2,1,3,1,3,2,3,1,3,1,3,2,3,1,3,2,3,1,2,1,2,2,3,1,2)
Outcomes <- matrix(c(3869,4014,8760,8941,2607,2593,4544,4539,1329,1367,2155,2149,1967,2039,4075,4073,1882,1901,3158,3196,4724,4711,3224,3224,640,644,3887,3811,4925,4983,2102,2161,1131,1141,200,167,570,547,149,163,341,336,45,36,113,138,49,46,156,143,66,68,62,56,127,158,52,63,15,10,61,44,130,111,21,21,31,32,433,331,937,781,157,135,300,295,37,25,98,78,207,136,218,223,130,112,73,50,155,126,25,17,20,22,18,11,82,74,109,83,37,38), ncol = 3)
covariate <- c(1,2,4,2,3,5,6,7,8,1,12,2,3,4,2,3,4)
colnames(Outcomes) <- c("Alive", "FnCVD", "FCVD")
#Outcomes <- Outcomes[,c(2,1,3)]
N <- apply(Outcomes, 1, sum)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", type = "fixed")
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", covariate = covariate, covariate.model = "exchangeable")
result <- network.run(network)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", baseline = "common", baseline.risk = "exchangeable")
result <- network.run(network)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", baseline = "independent")
result <- network.run(network)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", baseline = "exchangeable", baseline.risk = "independent")
result <- network.run(network)
exp(relative.effects.table(result))
Outcomes = rbind(Outcomes, c(1140, 31, 37))
N <- apply(Outcomes, 1, sum)
Study = c(Study, 17)
Treat = c(Treat, 3)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", baseline = "exchangeable")
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", type = "fixed")
result <- network.run(network)
network <- network.data(Outcomes, Study, Treat, N, response = "multinomial", baseline = "exchangeable")
result <- network.run(network)
calculate.deviance(result)
network.autocorr.diag(result)
network.autocorr.plot(result)
network.covariate.plot(result, base.treatment = 1, comparison.treatment = 2, base.category = 1, comparison.category = 2)
network.cumrank.tx.plot(result)
network.deviance.plot(result)
network.forest.plot(result, label.margin = 10)
network.gelman.diag(result)
network.gelman.plot(result)
Outcomes = c(3, 3, 14, 7, 11, 5, 127, 102, 27, 28, 6, 4, 152, 98, 48, 60, 37, 25, 188, 138, 52, 64, 47, 45, 16, 9, 45, 57, 31, 25, 38, 33, 12, 28, 6, 8, 3, 6, 40, 32, 43, 27, 39, 22)
N = c(39, 38, 116, 114, 93, 69, 1520, 1533, 365, 355, 52, 59, 939, 945, 471, 632, 282, 278, 1921, 1916, 583, 873, 266, 263, 293, 291, 883, 858, 147, 154, 213, 207, 122, 251, 154, 151, 134, 174, 218, 209, 364, 391, 674, 680)
Study = rep(1:22, each = 2)
Treat = rep(c(1,2), 22)
blocker <- list(Outcomes = Outcomes, N = N, Study = Study, Treat = Treat)
# covariate <- as.matrix(cbind(sample(22), sample(30, size = 22)), ncol = 2)
# add one more arm (three arm)
# Outcomes = c(Outcomes, 21)
# N = c(N, 660)
# Study = c(Study, 22)
# Treat = c(Treat, 3)
#init <- list()
#init[[1]] <- list(d = c(NA, 0), mu = rep(0, 22))
#init[[2]] <- list(d = c(NA, -1), mu = rep(-3, 22))
#init[[3]] <- list(d = c(NA, 2), mu = c(-3, 5, -1, -3, 7, -3, -4, -3, -3, 0, -3, -3, 0, 3, 5, -3, -3, -1, -3, -7, -3, -3))
network <- network.data(Outcomes, Study, Treat, N = N, response = "binomial", type = "fixed")
network <- network.data(Outcomes, Study, Treat, N = N, response = "binomial")
result <- network.run(network, n.run = 20000)
summary(result)
plot(result)
Study <- c("Morton 1984","Morton 1984","Smith 1986","Smith 1986","Rasmussen 1986","Rasmussen 1986","Abraham 1987","Abraham 1987","Ceremuzynski 1989","Ceremuzynski 1989","Singh 1990","Singh 1990","Shechter 1990","Shechter 1990","Shechter 1991","Shechter 1991","Feldstedt 1991","Feldstedt 1991","Woods 1992","Woods 1992","Wu 1992","Wu 1992","ISIS-4 1995","ISIS-4 1995","Shechter 1995","Shechter 1995","Thorgersen 1995","Thorgersen 1995","Bhargava 1995","Bhargava 1995","Urek 1996","Urek 1996","Raghu 1999","Raghu 1999","Gyamiani 2000","Gyamiani 2000","Santoro 2000","Santoro 2000","MAGIC 2000","MAGIC 2000","Zhu 2002","Zhu 2002","Nakashima 2004","Nakashima 2004")
Treat <- rep(c(2, 1), times = length(unique(Study)))
Outcomes <- c(1,2,2,7,4,14,1,1,1,3,6,11,1,9,2,4,10,8,90,118,5,12,2216,2103,4,17,4,8,3,3,1,0,6,18,2,10,0,1,475,472,101,134,1,3)
N <- c(40,36,92,93,56,74,48,46,25,23,81,81,50,53,21,25,150,148,1159,1157,125,102,29011,29039,96,98,130,122,40,38,31,30,169,181,50,50,75,75,3113,3100,1691,1488,89,91)
#covariate <- c(1984,1986,1986,1987,1989,1990,1990,1991,1991,1992,1992,1995,1995,1995,1995,1996,1999,2000,2000,2000,2002,2004)
network <- network.data(Outcomes, Study, Treat, N = N, response = "binomial")
result <- network.run(network)
############### Statins
Outcomes <- c(256, 182, 4, 1, 0, 1, 2, 2, 77, 80, 3, 33, 8, 1, 3, 3, 0, 1, 4, 3, 633, 498, 1, 2, 11, 4, 5, 4, 6, 4, 3, 0, 4, 2, 1, 3, 135, 106)
N <- c(2223, 2221, 125, 129, 52, 94, 166, 165, 3301, 3304, 1663, 6582, 459, 460, 155, 145, 42, 83, 223, 224, 4520, 4512, 124, 123, 188, 193, 78, 79, 202, 206, 532, 530, 178, 187, 201, 203, 3293, 3305)
Treat <- rep(c("Placebo", "Statin"), 19)
Study <- rep(1:19, each = 2)
covariate <- c(1,1,1,1,0,0,1,1,1,0,1,1,1,1,1,0,1,1,0)
Treat.order <- c("Placebo", "Statin")
network <- network.data(Outcomes, Study, Treat, N=N, response = "binomial", Treat.order = c("Placebo", "Statin"), covariate = covariate, covariate.model = "exchangeable")
network <- network.data(Outcomes, Study, Treat, N=N, response = "binomial", Treat.order = c("Placebo", "Statin"), covariate = covariate, covariate.type = "discrete")
#baseline
network <- network.data(Outcomes, Study, Treat, N=N, response = "binomial", Treat.order = Treat.order, baseline = "exchangeable", baseline.risk = "exchangeable")
inits <- list(list(d=c( NA, 0), Eta =c(0,0,0,0,0, 0,0,0,0,0, 0,0,0,0,0, 0,0,0,0), C1=0, sd=1)
,list(d=c( NA, -1), Eta =c(-3,-3,3,-3,3, -3,3,-3,3,-3, -3,-3,3,3,-3, 3,-3,-3,3), C1=-1, sd=3)
,list(d=c( NA, 2), Eta =c(-3,5,-1,-3,7, -3,-4,-3,-3,0, 5,0,-2,-5,1, -2,5,3,0), C1=1.5, sd=0.5))
result <- network.run(network)
##
#statins <- list(Outcomes = Outcomes, N = N, Treat = Treat, Study = Study, covariate = covariate, Treat.order = Treat.order)
#devtools::use_data(statins, mcnet)
network <- network.data(Outcomes, Study, Treat, N=N, response = "binomial", Treat.order = c("Placebo", "Statin"), covariate = covariate, covariate.type = "discrete")
result <- network.run(network)
########### Certolizumab
Outcomes <- c(15, 146, 4, 80, 9, 28, 19, 81, 5, 37, 1, 23, 33, 110, 22, 61, 0, 15, 5, 5, 14, 26, 22, 90)
N <- c(199, 393, 127, 246, 63, 65, 200, 207, 62, 67, 30, 59, 363, 360, 110, 165, 47, 49, 40, 40, 49, 50, 204, 205)
Study <- c("RAPID 1", "RAPID 1", "RAPID 2", "RAPID 2", "Kim 2007", "Kim 2007", "DE019", "DE019", "ARMADA", "ARMADA", "Weinblatt 1999", "Weinblatt 1999", "START", "START", "ATTEST", "ATTEST", "Abe 2006", "Abe 2006", "Strand 2006", "Strand 2006", "CHARISMA", "CHARISMA", "OPTION", "OPTION")
Treat <- c("Placebo", "CZP", "Placebo", "CZP", "Placebo", "Adalimumab", "Placebo", "Adalimumab", "Placebo", "Adalimumab", "Placebo", "Etanercept", "Placebo", "Infliximab", "Placebo", "Infliximab", "Placebo", "Infliximab", "Placebo", "Rituximab", "Placebo", "Tocilizumab", "Placebo", "Tocilizumab")
covariate <- c(6.15, 5.85, 6.85, 10.95, 11.65, 13, 8.1, 7.85, 8.3, 11.25, 0.915, 7.65)
Treat.order <- c("Placebo", "CZP", "Adalimumab", "Etanercept", "Infliximab", "Rituximab", "Tocilizumab")
network <- network.data(Outcomes, Study, Treat, N=N, response = "binomial", Treat.order = Treat.order)
network <- network.data(Outcomes, Study, Treat, N=N, response = "binomial", Treat.order = Treat.order, hy.prior = list("dhnorm", 0, 9.77))
#baseline
network <- network.data(Outcomes, Study, Treat, N=N, response = "binomial", Treat.order = Treat.order, baseline = "exchangeable", baseline.risk = "exchangeable")
#network <- network.data(Outcomes, Study, Treat, N=N, response = "binomial", Treat.order = Treat.order, baseline = "common", prec.Eta = 0.001)
result <- network.run(network)
devtools::install_github("MikeJSeo/bnma")
#devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- with(parkinsons_contrast, {
contrast.network.data(Outcomes, Treat, SE, na, V, type = "random", mean.d = 0.01, prec.d = 0.1, hy.prior = list("dhnorm", 0.01, 0.01))
})
result <- contrast.network.run(network)
summary(result)
devtools::document()
setwd("C:/Users/mike/Desktop/Github/bnma")
devtools::document()
devtools::install_github("MikeJSeo/bnma")
network <- with(smoking, {
ume.network.data(Outcomes, Study, Treat, N = N, response = "binomial", type = "random")
})
result <- ume.network.run(network)
devtools::install_github("MikeJSeo/bnma")
devtools::install_github("MikeJSeo/bnma")
install.packages("rlang")
install.packages("rlang")
devtools::install_github("MikeJSeo/bnma")
install.packages("igraph")
devtools::install_github("MikeJSeo/bnma")
devtools::install_github("MikeJSeo/bnma")
devtools::install_github("MikeJSeo/bnma")
network <- with(smoking, network.data(Outcomes = Outcomes, Study = Study, Treat = Treat, N = N, response = "binomial", mean.d = 0.1, hy.prior = list("dhnorm", 0, 5)))
#devtools::install_github("MikeJSeo/bnma")
library(bnma)
network <- with(smoking, network.data(Outcomes = Outcomes, Study = Study, Treat = Treat, N = N, response = "binomial", mean.d = 0.1, hy.prior = list("dhnorm", 0, 5)))
draw.network.graph(network)
